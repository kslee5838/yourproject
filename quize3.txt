CREATE TABLE category (
  id SERIAL,
  name VARCHAR(128) UNIQUE,
  PRIMARY KEY(id)
);

CREATE TABLE iso (
  id SERIAL,
  name VARCHAR(128) UNIQUE,
  PRIMARY KEY(id)
);

CREATE TABLE state (
  id SERIAL,
  name VARCHAR(128) UNIQUE,
  PRIMARY KEY(id)
);

CREATE TABLE region (
  id SERIAL,
  name VARCHAR(128) UNIQUE,
  PRIMARY KEY(id)
);

CREATE TABLE unesco(
  id SERIAL, 
  PRIMARY KEY(id), 
  category TEXT, 
  category_id INTEGER, 
  UNIQUE(category,category_id)
  );

SELECT DISTINCT category FROM unesco_raw;
INSERT INTO category(name) SELECT DISTINCT category FROM unesco_raw;
UPDATE unesco_raw SET category_id = (SELECT category.id FROM category WHERE category.name = unesco_raw.category);
SELECT * FROM unesco_raw limit 3;
INSERT INTO unesco (category, category_id) SELECT category, category_id FROM unesco_raw;
SELECT * FROM unesco JOIN category ON category.category_id = category.id;
